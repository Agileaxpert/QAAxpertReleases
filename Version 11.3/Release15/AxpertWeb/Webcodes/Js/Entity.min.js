/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,o=[],r=!0,s=!1;try{for(a=a.call(e);!(r=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);r=!0);}catch(l){s=!0,i=l}finally{try{r||null==a["return"]||a["return"]()}finally{if(s)throw i}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){s=!0,o=e},f:function(){try{r||null==a["return"]||a["return"]()}finally{if(s)throw o}}}}function ownKeys(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(a),!0).forEach(function(t){_defineProperty(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var isFetching=!1,dtCulture=eval(callParent("glCulture")),_entity,_entityCommon,currentEditFieldId=null,rowData,pageNo=1,Entity=function(){function e(){_classCallCheck(this,e),this.entityName="",this.entityTransId="",this.metaData={},this.listJson={},this.maxPageNumber=1,this.pageSize=100,this.kpiJson=[],this.chartsJson=[],this.chartsMetaData={},this.selectedChartsArr=[],this.selectedChartCaptions={},this.emptyRowsHtml="No data found",this.nullRowsHtml="Configure the fields properly in the 'Select Field(s)' option",this.fields="All",this.keyField="",this.filter=[],this.filterObj={},this.allowCreate=!0,this.isLastPage=!1,this.tableViewFlag=!1,this.viewChart=!0,this.captionsEnabled=!1,this.lastScrollTop=0,this.lastScrollLeft=0,this.properties={},this.modificationFields="",this.rightPanel="expanded"}return _createClass(e,[{key:"init",value:function(){if(parent.ShowDimmer(!1),this.getUrlParams(),this.inValid(this.entityTransId))this.catchError("Invalid Entity details");else{var e=JSON.parse(document.querySelector("#hdnEntityPageLoadData").value);this.properties=e.result.data.Properties,this.tableViewFlag=this.properties.TABLEVIEW&&"true"===this.properties.TABLEVIEW.toLowerCase()||!1,this.captionsEnabled=this.properties.CAPTIONVALUE&&"true"===this.properties.CAPTIONVALUE.toLowerCase()||!1,e.result.data.EntityName&&(this.entityName=e.result.data.EntityName),this.applyTheme(),this.rightPanelView(),highlightInitialSelection(),document.querySelector("#EntityTitle").innerHTML=this.entityName||e.result.data.EntityName;document.getElementById("body_Container");try{var t,a,n;this.metaData=e.result.data.MetaData;var i=this.metaData.find(function(e){return"dc1"===e.dcname});i&&i.tablename;this.listJson=null!==(t=e.result.data.ListData)&&void 0!==t&&null!==(a=t[0])&&void 0!==a&&a.data_json?JSON.parse(e.result.data.ListData[0].data_json):[],this.fields=this.properties.FIELDS||"All",this.keyField=this.properties.KEYFIELD||"",this.properties.CHARTS&&(this.selectedChartsArr=JSON.parse(this.properties.CHARTS)),this.maxPageNumber=e.result.data.PageNo,_entityCommon.isValid(this.properties.FILTERS)&&(_entityFilter.filterObj=JSON.parse(this.properties.FILTERS),_entityFilter.createFilterPills()),"All"==this.fields?this.modificationFields="modifiedon,modifiedby,createdby,createdon":this.modificationFields=this.properties.MODIFICATIONFIELDS||"",(null===(n=this.listJson)||void 0===n?void 0:n.length)>0&&(this.populateInitialView(),this.initCharts()),this.bindEvents(),this.addCustomParams(),parent.ShowDimmer(!1)}catch(o){showAlertDialog("error","Error occurred. Please check with administrator."),console.error(o)}}}},{key:"rightPanelView",value:function(){"expanded"===(this.properties.RIGHTPANEL||"expanded")?(document.getElementById("Entity_management_Right").style.setProperty("display","block","important"),document.querySelector("button[onclick='toggleRightPanel();']").style.setProperty("display","none","important")):(document.getElementById("Entity_management_Right").style.setProperty("display","none","important"),document.querySelector("button[onclick='toggleRightPanel();']").style.setProperty("display","inline-block","important"))}},{key:"addCustomParams",value:function(){var e=this.metaData.find(function(e){return"dc1"===e.dcname}),t=e?e.tablename:null;this.metaData.push({ftransid:this.entityTransId,fcaption:this.entityName,fldname:"createdon",fldcap:"Created on",cdatatype:"Date",fdatatype:"d",fmodeofentry:"calculate",hide:"F",props:null,normalized:"F",allowempty:"T",filtertype:"Text",tablename:t,dcname:"dc1"}),this.metaData.push({ftransid:this.entityTransId,fcaption:this.entityName,fldname:"createdby",fldcap:"Created by",cdatatype:"DropDown",fdatatype:"c",fmodeofentry:"calculate",hide:"F",props:null,normalized:"F",allowempty:"T",filtertype:"Text",tablename:t,dcname:"dc1"}),this.metaData.push({ftransid:this.entityTransId,fcaption:this.entityName,fldname:"modifiedon",fldcap:"Modified on",cdatatype:"Date",fdatatype:"d",fmodeofentry:"calculate",hide:"F",props:null,normalized:"F",allowempty:"T",filtertype:"Text",tablename:t,dcname:"dc1"}),this.metaData.push({ftransid:this.entityTransId,fcaption:this.entityName,fldname:"username",fldcap:"Modified by",cdatatype:"DropDown",fdatatype:"c",fmodeofentry:"calculate",hide:"F",props:null,normalized:"F",allowempty:"T",filtertype:"Text",tablename:t,dcname:"dc1"})}},{key:"generateHTMLBasedOnDataType",value:function(e,t){var a=e.fldname,n=getFieldDataType(e),i=e.fldcap?e.fldcap.replaceAll("*",""):"",o=e.props,r=t[a];if("modifiedon"===a.toLowerCase()||"username"===a.toLowerCase()||"createdby"===a.toLowerCase()||"createdon"===a.toLowerCase())return"";if(_entity.inValid(r)&&"BUTTON"!=n.toUpperCase())return"";var s="",l=this.captionsEnabled?"":'data-toggle="tooltip" data-placement="top" title="'.concat(i,'"');switch(this.captionsEnabled&&(s='<div class="Data-fields-items" '.concat(l,'>\n                        <div class="caption-style">\n                            <span class="txt-bold Data-field-caption">').concat(i,'</span>\n                            <span class="txt-bold Data-field-value">').concat(r,"</span>\n                        </div>\n                    </div>")),n.toUpperCase()){case"LARGE TEXT":s=s||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <p class="task-description moretext" style="margin-bottom:0px !important;">').concat(r,'</p>\n                            <a class="moreless-button" href="#">Read more</a>\n                        </div>');break;case"SHORT TEXT":s=s||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">description</span><span class="txt-bold Data-field-value">').concat(r,"</span>\n                        </div>");break;case"CURRENCY":s=s||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">payments</span><span class="txt-bold Data-field-value">').concat(r,"</span>\n                        </div>");break;case"DATE":var c=formatDate(r.replace("T00:00:00",""),dateFormat);s=this.captionsEnabled?'<div class="Data-fields-items Date-field" '.concat(l,'>\n                                    <div class="caption-style">\n                                        <span class="txt-bold Data-field-caption">').concat(i,'</span>\n                                        <span class="txt-bold Data-field-value">').concat(c,"</span> \x3c!-- Use formatted date here --\x3e\n                                    </div>\n                                </div>"):'<div class="Data-fields-items Date-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                    <span class="material-icons material-icons-style material-icons-2">today</span>\n                                    <span class="txt-bold Data-field-value">').concat(c,"</span>\n                                </div>");break;case"TIME":s=s||'<div class="Data-fields-items Time-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">schedule</span><span class="txt-bold Data-field-value">').concat(r,"</span>\n                        </div>");break;case"LINK":s=s||'<div class="Data-fields-items link-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">link</span><span class="txt-bold Data-field-value">').concat(r,"</span>\n                        </div>");break;case"MOBILE":case"PHONE":s=s||'<div class="Data-fields-items Email-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">phone</span><span class="txt-bold Data-field-value">').concat(r,"</span>\n                        </div>");break;case"PINCODE":case"ZIPCODE":s=s||'<div class="Data-fields-items Email-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">location_on</span><span class="txt-bold Data-field-value">').concat(r,"</span>\n                        </div>");break;case"EMAIL":s=s||'<div class="Data-fields-items Email-field truncate" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">mail</span><span class="txt-bold Data-field-value" data-text="').concat(r,'" onclick="showPopup(this)">').concat(r,"</span>\n                        </div>");break;case"BOOL":s="T"===r||"F"===r?s||'<div class="Data-fields-items Email-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                <div class="form-check form-switch">\n                                    <input class="form-check-input" type="checkbox" role="switch" ').concat("T"===r?"checked":"",' readonly>\n                                    <span class="txt-bold Data-field-value">').concat(i,"</span>\n                                </div>\n                            </div>"):s||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                <span class="txt-bold Data-field-value">').concat(r,"</span>\n                            </div>");break;case"BUTTON":var d=o.split("|")[0].split("~")[1];s=s||'<a href="javascript:void(0)" title="View form"\n                           class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center btn-sm me-2 ">\n                            <span class="material-icons material-icons-style material-icons-2" style="color: darkmagenta;">'.concat(d,"</span>").concat(i,"\n                        </a>");break;case"ATTACHMENTS":if((null==r?void 0:r.length)>0){var u,p=parseFilePath(r);if((null===(u=p.filename)||void 0===u?void 0:u.length)>0){var m=getIconClass(getFileType(r));s=s||'<div class="Files-Attached" '.concat(l,">\n                                    ").concat(m,'\n                                    <div class="ms-1 fw-semibold">\n                                        <a class="attached-filename" onclick="downloadFileFromPath(\'').concat(p.folder.replaceAll("\\","\\\\"),"','").concat(p.filename,".").concat(p.ext,"')\">").concat(p.filename,"</a>\n                                    </div>\n                                </div>")}}break;default:s="T"===r||"F"===r?s||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                <div class="d-flex align-items-center">\n                                    <div class="form-check ms-1">\n                                        <input class="form-check-input" type="checkbox" ').concat("T"===r?"checked":""," readonly disabled>\n                                    </div>\n                                </div>\n                            </div>"):s||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                <span class="txt-bold Data-field-value">').concat(r,"</span>\n                            </div>")}return s}},{key:"populateInitialView",value:function(){var e=document.getElementById("body_Container");e.removeEventListener("scroll",scrollListener),this.tableViewFlag?toggleView():(createListHTML(this.listJson,pageNo),e.addEventListener("scroll",scrollListener)),$('[data-toggle="tooltip"]').tooltip(),initReadMore()}},{key:"toggleCaptions",value:function(){var e=this;this.captionsEnabled=!this.captionsEnabled;var t={page:"Entity",transId:_entity.entityTransId,properties:{CAPTIONVALUE:this.captionsEnabled},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(t,function(){e.captionsEnabled=!e.captionsEnabled,_entity.saveCaptionValue(),_entity.refreshData()},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}},{key:"saveCaptionValue",value:function(){var e={page:"Entity",transId:_entity.entityTransId,properties:{CAPTIONVALUE:this.captionsEnabled},allUsers:!1};_entityCommon.setAnalyticsDataWS(e,function(){_this.refreshData()},function(e){console.error("Error in SetEntityFieldsWS:",e),ShowDimmer(!1)})}},{key:"refreshData",value:function(){_entity.reloadEntityPage()}},{key:"generateCustomKPIHTML",value:function(e,t){var a="";return e.forEach(function(e){var n,i=(e.criteria||"").split("~"),o=i[1].trim(),r=i[2].trim();a+='\n           <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n    <a href="#" class="Invoice-item" >\n        <div class="Invoice-icon">\n            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n        </div>\n        <div class="Invoice-content" >\n            <h6 class="subtitle" data-keyname="'.concat(e.keyname||t,'" onclick="navigateToListPage(\'').concat(o,"', '").concat(r,"', this)\">").concat(e.keyname||t,'</h6>\n            <h3 class="title">').concat((null===(n=e.keyvalue)||void 0===n?void 0:n.toLocaleString())||0,'</h3>\n        </div>\n        <div class="Invoice-icon2"></div>\n    </a>\n</div>\n\n        ')}),a}},{key:"getEntityListData",value:function(e){var t=this,a={transId:t.entityTransId,fields:t.fields,pageNo:e,pageSize:t.pageSize,filter:t.filter};1==e&&(t.isLastPage=!1),t.isLastPage?parent.ShowDimmer(!1):this.callAPI("../aspx/Entity.aspx/GetEntityListDataWS",a,!1,function(a){if(a.success){var n,i,o;parent.ShowDimmer(!1);var r,s=JSON.parse(JSON.parse(a.response).d);s=null!==(n=null===(i=s.result.data.ListData)||void 0===i?void 0:null===(o=i[0])||void 0===o?void 0:o.data_json)&&void 0!==n?n:"[]";try{s.constructor!=Array&&(s=JSON.parse(s))}catch(l){return void showAlertDialog("error","Error occurred in data fetch.")}if(0===s.length)return void(1===e?(t.listJson=[],document.querySelector("#body_Container").innerHTML=t.emptyRowsHtml,document.querySelector("#table-body_Container").innerHTML=t.emptyRowsHtml):(t.isLastPage=!0,noMoreRecordsMessage.style.display="block",setTimeout(function(){noMoreRecordsMessage.style.display="none"},3e3)));1===e&&(t.listJson=[],document.querySelector("#body_Container").innerHTML="",document.querySelector("#table-body_Container").innerHTML=""),(r=t.listJson).push.apply(r,_toConsumableArray(s)),t.maxPageNumber=e,("table"===_entity.viewMode?createTableViewHTML:createListHTML)(t.listJson,e),$('[data-toggle="tooltip"]').tooltip(),initReadMore()}else parent.ShowDimmer(!1)})}},{key:"hideChartsMenu",value:function(){var e;null===(e=document.querySelector("#add_chart"))||void 0===e||e.click()}},{key:"openEntityForm",value:function(e,t,a,n,i){this.updateRelatedData(t,i);var o="../aspx/EntityForm.aspx?ename=".concat(e,"&tstid=").concat(t,"&recid=").concat(a,"&keyval=").concat(n);parent.LoadIframe(o)}},{key:"updateRelatedData",value:function(e,t){window.top.entityNavList||(window.top.entityNavList={}),window.top.entityNavList[e]=this.getNearestRecords(t),window.top.entityNavList.lastTransId=e,window.top.entityNavList.lastCaption="Other ".concat(this.entityName)}},{key:"getSelectedChartsCriteria",value:function(){var e=this,t=[];return e.selectedCharts.split("^").forEach(function(a){var n=a.split("~"),i=n[1],o=n[2];if(""!=i){var r=e.chartsMetaData.GroupFld[i];t.push("".concat(a,"~").concat(r.normalized,"~").concat(r.srctable||"","~").concat(r.srcfield||"","~").concat(r.allowempty,"~").concat(r.tablename,"~~"))}else{var s=e.chartsMetaData.AggFld[o];t.push("".concat(a,"~").concat(s.normalized,"~").concat(s.srctable||"","~").concat(s.srcfield||"","~").concat(s.allowempty,"~").concat(s.tablename,"~~"))}}),t.join("^")}},{key:"getChartCriteria",value:function(e){return e.split("~").slice(0,4).join("~")}},{key:"generateGeneralKPIHTML",value:function(e){var t="";return t+='\n            <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                <a href="#" class="Invoice-item">\n                    <div class="Invoice-icon">\n                        <span class="material-icons material-icons-style material-icons-2">bar_chart</span><i class="fas fa-signal"></i>\n                    </div>\n                    <div class="Invoice-content">\n                        <h6 class="subtitle">Total</h6>\n                        <h3 class="title">'.concat(e.totrec,'</h3>\n                    </div>\n                    <div class="Invoice-icon2"></div>\n                </a>\n            </div>\n        '),0!==e.cyear&&(t+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n                            <h6 class="subtitle">This year</h6>\n                            <h3 class="title">'.concat(e.cyear,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            ')),0!==e.cmonth&&(t+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n                            <h6 class="subtitle">This month</h6>\n                            <h3 class="title">'.concat(e.cmonth,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            ')),0!==e.cweek&&(t+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n                            <h6 class="subtitle">This week</h6>\n                            <h3 class="title">'.concat(e.cweek,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            ')),0!==e.cyesterday&&(t+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n                            <h6 class="subtitle">Yesterday</h6>\n                            <h3 class="title">'.concat(e.cyesterday,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            ')),0!==e.ctoday&&(t+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n                            <h6 class="subtitle">Today</h6>\n                            <h3 class="title">'.concat(e.ctoday,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            ')),t}},{key:"getEntityChartsData",value:function(e,t){var a=this,n="/aspx/Analytics.aspx/GetAnalyticsChartsDataWS";"General"!=t&&(n="/aspx/Analytics.aspx/GetAnalyticsMultipleChartsDataWS"),$.ajax({url:top.window.location.href.toLowerCase().substring(0,top.window.location.href.toLowerCase().indexOf("/aspx/"))+n,type:"POST",cache:!1,async:!0,dataType:"json",data:JSON.stringify(e),contentType:"application/json",success:function(e){try{if((r=JSON.parse(e.d)).result.success)var n=JSON.parse(r.result.charts[0].data_json);if("General"==t){if(n.length>0){var i=n[0],o=_entity.generateGeneralKPIHTML(i);return void(document.querySelector("#KPI-2 .row").innerHTML=o)}}else if(document.querySelector("#Homepage_CardsList_Wrapper").innerHTML="",n.length>0){var r;(r=JSON.parse(e.d)).result.success&&(a.chartsJson=r);try{var s=[];a.chartsJson.result.charts.forEach(function(e,t){var n=JSON.parse(e.data_json),i=a.getChartCriteria(n[0].criteria),o=JSON.parse(e.data_json).map(function(e){return{data_label:e.keyname,value:e.keyvalue}});s.push({chartsid:"chart"+t.toString(),charttype:"chart",chartjson:JSON.stringify(o),chartname:"".concat(a.getChartCaptions(i))})}),a.chartsJson=s}catch(f){return void console.log("Error in charts"+f)}}else handleNoChartData();callParentNew("LoadIframe");var l={},c={},d="",u="",p={dirLeft:!0,enableMasonry:!1,homePageType:"cards",isCardsDashboard:!0,isMobile:isMobileDevice()},m={css:[],js:[]};m.js.push("/ThirdParty/lodash.min.js"),m.js.push("/ThirdParty/deepdash.min.js"),m.js.push("/Js/handlebars.min.js?v=1"),m.js.push("/Js/handleBarsHelpers.min.js"),m.js.push("/ThirdParty/Highcharts/highcharts.js"),m.js.push("/ThirdParty/Highcharts/highcharts-3d.js"),m.js.push("/ThirdParty/Highcharts/highcharts-more.js"),m.js.push("/ThirdParty/Highcharts/highcharts-exporting.js"),m.js.push("/Js/high-charts-functions.js?v=20"),m.js.push("/Js/AxInterface.js?v=10"),m.js.push("/ThirdParty/DataTables-1.10.13/extensions/Extras/moment.min.js"),m.css.push("/ThirdParty/fullcalendar/lib/main.min.css"),m.js.push("/ThirdParty/fullcalendar/lib/main.min.js"),p.isMobile&&m.js.push("/ThirdParty/jquery-ui-touch-punch-master/jquery.ui.touch-punch.min.js"),p.enableMasonry&&m.js.push("/ThirdParty/masonry/masonry.pkgd.min.js"),m.js.push("/js/entity-charts.min.js?v=2"),document.getElementsByTagName("body")[0].classList.contains("btextDir-rtl")&&(p.dirLeft=!1),loadAndCall({files:m,callBack:function(){$(function(){ShowDimmer(!0),deepdash(_);if(l.value=JSON.stringify(_entity.chartsJson),c.value=JSON.stringify([]),""!=(d="")){d=d.replace(/'/g,"'");var e=parseXml(d),t=xml2json(e,"");u=JSON.parse(t)}appGlobalVarsObject._CONSTANTS.menuConfiguration=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.menuConfiguration,{menuJson:u}),appGlobalVarsObject._CONSTANTS.cardsPage={setCards:!1,cards:[]},$.axpertUI.options.cardsPage.cards=[],appGlobalVarsObject._CONSTANTS.cardsPage=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.cardsPage,{setCards:!0,cards:(JSON.parse(""!==l.value?ReverseCheckSpecialChars(l.value):"[]",function(e,t){try{return"object"===_typeof(t)||isNaN(t)||""===t.toString().trim()?t:"string"==typeof t&&(t.startsWith("0")||t.startsWith("-"))?parseFloat(t,10):JSON.parse(t)}catch(a){return t}})||[]).map(function(e){return _.mapKeys(e,function(e,t){return t.toString().toLowerCase()})}),design:(JSON.parse(""!==c.value?c.value:"[]",function(e,t){try{return"object"===_typeof(t)||isNaN(t)||""===t.toString().trim()?t:"string"==typeof t&&(t.startsWith("0")||t.startsWith("-"))?parseFloat(t,10):JSON.parse(t)}catch(a){return t}})||[]).map(function(e){return _.mapKeys(e,function(e,t){return t.toString().toLowerCase()})}),enableMasonry:p.enableMasonry,staging:{iframes:".splitter-wrapper",cardsFrame:{div:".cardsPageWrapper",cardsDiv:"#Homepage_CardsList_Wrapper",cardsDesigner:".cardsDesigner",cardsDesignerToolbar:".designer",editSaveButton:".editSaveCardDesign",icon:"span.material-icons",divControl:"#arrangeCards"}}});appGlobalVarsObject.lcm;var a=$.axpertUI.init({isHybrid:appGlobalVarsObject._CONSTANTS.isHybrid,isMobile:p.isMobile,compressedMode:appGlobalVarsObject._CONSTANTS.compressedMode,dirLeft:p.dirLeft,axpertUserSettings:{settings:appGlobalVarsObject._CONSTANTS.axpertUserSettings},cardsPage:appGlobalVarsObject._CONSTANTS.cardsPage});appGlobalVarsObject._CONSTANTS.cardsPage=a.cardsPage,ShowDimmer(!1)}),$.axpertUI.cardsPage._addCardHeader=function(e,t){e.find(".card-title").attr("title",t.chartname||"").find("headerContent").replaceWith(t.chartname||""),e.find(".card-header").attr("data-bs-target","#".concat(t.chartsid.replaceAll("~",""))),e.find(".KC_Items_Content").attr("id","".concat(t.chartsid.replaceAll("~",""))),e.attr("title",t.chartname||"");var a='<span class="material-icons material-icons-style" onclick="_entity.deleteChart(\''.concat(t.chartsid,"')\">close</span>");e.find("toolbarContent").replaceWith(a)}}})}catch(f){console.error("Error processing summary data:",f)}}})}},{key:"createChartsFieldsForSelection",value:function(){var e={GroupFld:{},AggFld:{}},t=document.querySelector("select#grpFld");this.metaData.filter(function(e){return"T"===e.grpfield&&"T"===e.listingfld}).forEach(function(a){var n=document.createElement("option");n.value=a.fldname,n.textContent="".concat(a.fldcap||"","(").concat(a.fldname,")"),t.appendChild(n),e.GroupFld[a.fldname]={cnd:a.cnd,fldcap:a.fldcap||"",fldname:a.fldname,normalized:a.normalized,allowempty:a.allowempty,srctable:a.srctable,srcfield:a.srcfield,tablename:a.tablename}});var a=document.querySelector("select#subEnt");if(a){var n=document.createElement("option");n.value=this.entityTransId,n.textContent="".concat(this.entityName,"(").concat(this.entityTransId,")"),a.appendChild(n)}var i=document.querySelector("select#aggFld");this.metaData.filter(function(e){return"T"===e.aggfield&&"T"===e.listingfld}).forEach(function(t){var a=document.createElement("option");a.value=t.fldname,a.textContent="".concat(t.fldcap||"","(").concat(t.fldname,")"),i.appendChild(a),e.AggFld[t.fldname]={cnd:t.cnd,fldcap:t.fldcap||"",fldname:t.fldname,normalized:t.normalized,allowempty:t.allowempty,srctable:t.srctable,srcfield:t.srcfield,tablename:t.tablename}}),document.getElementById("aggFld").addEventListener("change",function(){var e=document.getElementById("aggCond");"count"===this.value?(e.value=0,e.disabled=!0):(e.value="sum",e.disabled=!1)}),this.chartsMetaData=e}},{key:"getSelectedCharts",value:function(){document.getElementById("grpFld").value,document.getElementById("aggCond").value,document.getElementById("aggFld").value;var e={aggField:"count",aggFunc:"count",aggTransId:this.entityTransId,groupField:"all",groupTransId:this.entityTransId,page:"Entity",transId:this.entityTransId};if(this.getEntityChartsData(e,"General"),this.selectedChartsArr.length){var t={page:"Entity",transId:this.entityTransId,charts:this.selectedChartsArr};this.getEntityChartsData(t),document.querySelector(".NO-KPI-Items").classList.add("d-none")}else document.querySelector(".NO-KPI-Items").classList.remove("d-none");ShowDimmer()}},{key:"setSelectedCharts",value:function(){var e={page:"Entity",transId:this.entityTransId,properties:{CHARTS:JSON.stringify(this.selectedChartsArr)},confirmNeeded:!0,allUsers:!0};_entityCommon.setAnalyticsDataWS(e,function(){window.location.reload()},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}},{key:"clearChartSelection",value:function(){if(confirm("Clear all Charts?")){this.selectedChartsArr=[],this.setSelectedCharts()}}},{key:"applyChartSelection",value:function(){var e=document.getElementById("grpFld").value,t=document.getElementById("aggCond").value,a=document.getElementById("aggFld").value;if("count"==a)t="count";else if("0"===t)return showAlertDialog("error","Select a valid Display function"),void document.getElementById("aggCond").focus();"0"===e&&(e="");var n={aggField:a,aggFunc:t,aggTransId:this.entityTransId,groupField:e,groupTransId:this.entityTransId,page:"Entity",transId:this.entityTransId},i={aggField:n.aggField,aggFunc:n.aggFunc,aggTransId:n.aggTransId,groupField:n.groupField,groupTransId:n.groupTransId};this.selectedChartsArr.push(i),this.setSelectedCharts(),document.querySelector(".NO-KPI-Items").classList.add("d-none")}},{key:"getChartCaptions",value:function(e){if(!this.selectedChartCaptions[e]){var t=e.split("~"),a=t[1],n=this.chartsMetaData.GroupFld[a],i=t[3],o=t[2],r=this.chartsMetaData.AggFld[o],s="";s="count"==i?"".concat(n.fldcap||""," wise ").concat(i):""!=a?"".concat(n.fldcap||""," wise ").concat(r.fldcap||"","(").concat(i,")"):"".concat(r.fldcap||"","(").concat(i,")"),this.selectedChartCaptions[e]=s}return this.selectedChartCaptions[e]}},{key:"filterByFldname",value:function(e,t){return e.filter(function(e){return e.fldname===t})}},{key:"setSelectedFields",value:function(){var e=this,t={page:"Entity",transId:e.entityTransId,properties:{KEYFIELD:e.keyField,FIELDS:e.fields},allUsers:!1};_entityCommon.setAnalyticsDataWS(t,function(){e.reloadEntityPage()},function(e){console.error("Error in SetEntityFieldsWS:",e),ShowDimmer(!1)})}},{key:"reloadPage",value:function(){window.location.reload()}},{key:"deleteChart",value:function(e){if(confirm("Delete this chart?")){var t=e.replace("chart","");(t=parseInt(t))>-1&&this.selectedChartsArr.splice(t,1),this.setSelectedCharts()}}},{key:"showTimeLine",value:function(e,t){(axTimeLineObj=new ProcessTimeLine).keyvalue=t,axTimeLineObj.processName=e,this.inValid(axTimeLineObj.keyvalue)||"NA"==axTimeLineObj.keyvalue||axTimeLineObj.getTimeLineData()}},{key:"initCharts",value:function(){this.createChartsFieldsForSelection(),this.getSelectedCharts()}},{key:"getUrlParams",value:function(){var e=window.location.search,t=new URLSearchParams(e);this.entityName=t.get("ename"),this.entityTransId=t.get("tstid")}},{key:"bindEvents",value:function(){this.bindThemeEvent(),this.bindUtilityEvent(),document.querySelector("#fieldCaptionsMenuItem").addEventListener("click",function(e){e.preventDefault(),_entity.toggleCaptions()})}},{key:"openNewTstruct",value:function(){parent.LoadIframe("../aspx/tstruct.aspx?transid=".concat(this.entityTransId,"&dummyload=false"))}},{key:"editEntity",value:function(e){var t={page:"Entity",transId:this.entityTransId,recordId:e};return _entityCommon.getEntityEditableFlag(t)?(parent.LoadIframe("../aspx/tstruct.aspx?transid=".concat(this.entityTransId,"&act=load&recordid=").concat(e,"&dummyload=false")),!0):(showAlertDialog("error","User does not have 'Edit' access for this record. Please check with administrator."),!1)}},{key:"reloadEntityPage",value:function(){parent.LoadIframe("../aspx/Entity.aspx?ename=".concat(this.entityName,"&tstid=").concat(this.entityTransId))}},{key:"bindThemeEvent",value:function(){var e=this;document.querySelectorAll("#selectThemes .menu-link").forEach(function(t){t.addEventListener("click",function(a){a.preventDefault();var n=this.getAttribute("data-target");e.updateTheme(n),e.updateActiveClass(t),localStorage.setItem("selectedTheme-".concat(e.entityName),n)})})}},{key:"bindUtilityEvent",value:function(){var e=this;document.querySelectorAll("#exportMenuItem .menu-link").forEach(function(t){t.addEventListener("click",function(t){t.preventDefault();var a=this.getAttribute("data-target");e.handleUtilityAction(a)})})}},{key:"handleUtilityAction",value:function(e){handleExport(e,"#table-body_Container .table")}},{key:"applyTheme",value:function(){var e=localStorage.getItem("selectedTheme-".concat(this.entityName));if(e){this.updateTheme(e);var t=document.querySelector('#selectThemes .menu-link[data-target="'.concat(e,'"]'));t&&this.updateActiveClass(t)}}},{key:"updateActiveClass",value:function(e){document.querySelectorAll("#selectThemes .menu-link").forEach(function(e){e.classList.remove("active")}),e.classList.add("active")}},{key:"updateTheme",value:function(e){var t=document.body;t.classList.remove("lightTheme","blackTheme","gradTheme","compactTheme"),"lightTheme"===e||"light"===e?t.classList.add("lightTheme"):"blackTheme"===e||"dark"===e?t.classList.add("blackTheme"):"gradTheme"===e||"gradient"===e||"system"===e?t.classList.add("gradTheme"):"compactTheme"!==e&&"pattern"!==e||t.classList.add("compactTheme")}},{key:"getNearestRecords",value:function(e){var t=this,a=t.listJson.filter(function(e){return!1===t.inValid(e[e.keycol])}),n=a.findIndex(function(t){return t.rno===e});if(-1===n)return[];var i=[];if(n>0){var o=_objectSpread(_objectSpread({},a[n-1]),{},{navtype:"prev"});i.push(o)}var r=_objectSpread(_objectSpread({},a[n]),{},{navtype:"current"});if(i.push(r),n<a.length-1){var s=_objectSpread(_objectSpread({},a[n+1]),{},{navtype:"next"});i.push(s)}return i}},{key:"callAPI",value:function(e,t,a,n){var i=this,o=new XMLHttpRequest;o.open("POST",e,a),o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.isAxpertFlutter&&(o.setRequestHeader("Authorization","Bearer ".concat(armToken)),t.armSessionId=armSessionId),o.onreadystatechange=function(){4==this.readyState&&(200==this.status?n({success:!0,response:this.responseText}):(i.catchError(this.responseText),n({success:!1,response:this.responseText})))},o.send(JSON.stringify(t))}},{key:"catchError",value:function(e){showAlertDialog("error",e)}},{key:"showSuccess",value:function(e){showAlertDialog("success",e)}},{key:"dataConvert",value:function(e,t){if("AXPERT"==t)try{if("undefined"!=typeof(e=JSON.parse(e.d)).result[0].result.row)return e.result[0].result.row;if("undefined"!=typeof e.result[0].result)return e.result[0].result}catch(a){ShowDimmer(!1),this.catchError(a.message)}else if("ARM"==t)try{if(this.isAxpertFlutter||(e=JSON.parse(e.d)),e.result&&e.result.success){if(!this.isUndefined(e.result.data))return e.result.data}else this.isUndefined(e.result.message)||this.catchError(e.result.message)}catch(a){ShowDimmer(!1),this.catchError(a.message)}return e}},{key:"generateFldId",value:function(){return"fid".concat(Date.now()).concat(Math.floor(9e4*Math.random())+1e4)}},{key:"isEmpty",value:function(e){return""==e}},{key:"isNull",value:function(e){return null==e}},{key:"isNullOrEmpty",value:function(e){return null==e||""==e}},{key:"inValid",value:function(e){return null==e||void 0===e||""==e}},{key:"isUndefined",value:function(e){return void 0===e}}]),e}(),Field=_createClass(function e(t){_classCallCheck(this,e),this.fldcap=t.fldcap||"",this.fldname=t.fldname,this.cdatatype=t.cdatatype,this.fdatatype=t.fdatatype,this.moe=t.moe,this.hide=t.hide,this.props=t.props}),EntityMetaData=_createClass(function t(e){if(_classCallCheck(this,t),!e||!Array.isArray(e))throw new Error("Invalid JSON data");this.metadata=e.map(function(e){return new Field(e)})});function createListHTML(e,t){var a=$("#body_Container");isCardView||a.html("");var n="",i=filterRowsByPage(e,t),o=[],r=[],s=[],l=[];$.each(_entity.metaData,function(e,t){if("T"===t.hide)return!0;var a=getFieldDataType(t).toUpperCase();"BUTTON"===a?l.push(t):"ATTACHMENTS"===a?r.push(t):"LARGE TEXT"===a?o.push(t):s.push(t)});var c,d=_entity.keyField,u=!1,p=_createForOfIteratorHelper(i);try{for(p.s();!(c=p.n()).done;){var m=c.value;if(!m.hasOwnProperty(d)){var f=getKeyField();d=f?f.fldname:_entity.keyField}if(m.keycol=d,!_entity.inValid(m[d])&&"--"!=m[d]){if(u=!0,n+='<div class="Project_items" id="row_'.concat(m.recordid,'">\n                <div class="card">\n                    <div class="col-xl-12 col-md-12 d-flex flex-column flex-column-fluid">'),n+=' <div class="page-Header">\n                        <h3 class="card-title collapsible cursor-pointer rotate" data-bs-toggle="collapse"\n                            aria-expanded="true" data-bs-target="#Sub-Entity_wrapper" >\n                            <input class="Select-Project" type="checkbox" id="checkbox_'.concat(m.recordid,'" data-recordid="').concat(m.recordid,'" value="">\n                            <span class="Project_title" onclick="_entity.openEntityForm(\'').concat(_entity.entityName,"', '").concat(m.transid,"', '").concat(m.recordid,"', '").concat(m[d].replace("T00:00:00",""),"', ").concat(m.rno,')">').concat(m[d].replace("T00:00:00",""),'</span>\n                            <input type="hidden" class="transid" id="transid_').concat(m.recordid,'" value="').concat(m.transid,'"/>\n                            <input type="hidden" class="recid" id="recid_').concat(m.recordid,'" value="').concat(m.recordid,'"/>\n                            <div class="Project_updates">\n                            </div>\n                        </h3>\n                        <div id="" class="card-toolbar">\n                            <div class="d-flex">\n                                <div class="edit-container">\n                                    <button type="button" id=""\n                                        class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm me-3"\n                                        data-bs-toggle="tooltip" title="Edit" data-bs-original-title="Edit"\n                                        onclick="return _entity.editEntity(\'').concat(m.recordid,'\')">\n                                        <span class="material-icons material-icons-style material-icons-2" style="color: red;">\n                                            edit_note\n                                        </span>\n                                    </button>\n                                </div>\n                                <button type="submit" id=""\n                                    class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm me-3 d-none"\n                                    data-bs-toggle="tooltip" title="" data-bs-original-title="Options">\n                                    <span class="material-icons material-icons-style material-icons-2" style="color: #47BE7D;">\n                                        more_vert\n                                    </span>\n                                </button>\n                            </div>\n                        </div>\n                    </div>'),!(_entity.inValid(m.modifiedby)||_entity.inValid(m.modifiedon)||_entity.inValid(m.createdby)||_entity.inValid(m.createdon))){var y=moment(m.modifiedon).format("DD/MM/YYYY"),h=moment(m.modifiedon).format("HH:mm:ss"),v=moment(m.modifiedon).fromNow(),g=moment(m.createdon).format("DD/MM/YYYY"),b=moment(m.createdon).format("HH:mm:ss"),T=moment(m.createdon).fromNow(),w="",_="",S="",C="";_entity.modificationFields.includes("modifiedby")&&m.modifiedby&&(w="Modified by: ".concat(m.modifiedby)),_entity.modificationFields.includes("createdby")&&m.createdby&&(S="Created by: ".concat(m.createdby)),_entity.modificationFields.includes("modifiedon")&&m.modifiedon&&(_="Modified on: ".concat(y," ").concat(h)),_entity.modificationFields.includes("createdon")&&m.createdon&&(C="Created on: ".concat(g," ").concat(b));var k="";_entity.modificationFields.includes("createdby")&&_entity.modificationFields.includes("modifiedby")?k="".concat(w,"\n").concat(S):_entity.modificationFields.includes("createdby")&&!_entity.modificationFields.includes("modifiedby")?k=S:!_entity.modificationFields.includes("createdby")&&_entity.modificationFields.includes("modifiedby")&&(k=w),n+='<div class="workflow-container" style="display: flex; align-items: center;">\n                                    <div class="workflow-row" style="display: flex; align-items: center;">\n                                        <div class="workflow-items" style="display: flex; align-items: center;">',k&&(n+='<div class="symbol symbol-25px symbol-circle initialized" data-bs-toggle="tooltip" title="'.concat(k,'" data-bs-original-title="').concat(k,'">\n                                        <span class="symbol-label bg-warning text-inverse-warning fw-bold">').concat(m.modifiedby[0],"</span>\n                                     </div>")),_entity.modificationFields.includes("createdby")&&_entity.modificationFields.includes("modifiedby")?n+='<span data-toggle="tooltip" title="'.concat(k,'" class="Project_updates-value" style="margin-left: 10px;">\n                                        ').concat(m.modifiedby.split("@")[0],"\n                                     </span>"):_entity.modificationFields.includes("createdby")&&!_entity.modificationFields.includes("modifiedby")?n+='<span data-toggle="tooltip" title="'.concat(k,'" class="Project_updates-value" style="margin-left: 10px;">\n                                        ').concat(m.createdby.split("@")[0],"\n                                     </span>"):!_entity.modificationFields.includes("createdby")&&_entity.modificationFields.includes("modifiedby")&&(n+='<span data-toggle="tooltip" title="'.concat(k,'" class="Project_updates-value" style="margin-left: 10px;">\n                                        ').concat(m.modifiedby.split("@")[0],"\n                                     </span>")),k="",_entity.modificationFields.includes("createdon")&&_entity.modificationFields.includes("modifiedon")?k="".concat(_,"\n").concat(C):_entity.modificationFields.includes("createdon")&&!_entity.modificationFields.includes("modifiedon")?k=C:!_entity.modificationFields.includes("createdon")&&_entity.modificationFields.includes("modifiedon")&&(k=_),k?n+='<span class="Project_updates-value" data-toggle="tooltip" data-placement="top" title="'.concat(k,'" \n                                         data-name="').concat(y," ").concat(h,'" style="margin-left: 10px;">\n                                         last modified ').concat(v,"\n                                     </span>"):_entity.modificationFields.includes("createdon")&&!_entity.modificationFields.includes("modifiedon")?n+='<span class="Project_updates-value" data-toggle="tooltip" data-placement="top" title="'.concat(C,'" \n                                         data-name="').concat(g," ").concat(b,'" style="margin-left: 10px;">\n                                         created on: ').concat(T,"\n                                     </span>"):!_entity.modificationFields.includes("createdon")&&_entity.modificationFields.includes("modifiedon")&&(n+='<span class="Project_updates-value" data-toggle="tooltip" data-placement="top" title="'.concat(_,'" \n                                         data-name="').concat(y," ").concat(h,'" style="margin-left: 10px;">\n                                         last modified ').concat(v,"\n                                     </span>")),n+="</div></div>",m.axpeg_status&&""!==m.axpeg_status.toString()&&"0"!==m.axpeg_status.toString()&&(n+='<div class="status-timeline" style="display: flex; align-items: center; margin-left: 20px;">\n                                        <span class="material-icons material-icons-style material-icons-2" style="margin-right: 10px; margin-bottom: 10px;">people</span>\n                                        <button id="pd_timeline" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm entity-timelines" \n                                                data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end" \n                                                data-kt-menu-flip="top-end" data-kt-menu-attach="parent" title="Timeline" \n                                                style="margin-right: 10px; margin-bottom: 10px;">\n                                            <span class="material-icons material-icons-style material-icons-2">history</span>\n                                        </button>\n                                        <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light fw-bolder w-400px py-3" \n                                             data-kt-menu="true" data-id="pd_timeline" \n                                             data-processname="'.concat(m.axpeg_processname,'" data-keyvalue="').concat(m.axpeg_keyvalue,'">\n                                        </div>\n                                    </div>')),n+="</div>"}n+=generateRowElements(s,o,r,m),n+=generateRowButtonHTML(l,m),n+="</div></div></div>"}}}catch(I){p.e(I)}finally{p.f()}i.length&&!u?a.append(this.nullRowsHtml):""!==n?(a.append(n),initReadMore(),KTMenu.init(),document.querySelectorAll(".entity-timelines").forEach(function(e){KTMenu.getInstance(e).on("kt.menu.dropdown.show",function(e){var t=KTMenu.getInstance(e).element;t.innerHTML='<div id="TimeLine_overall" class="content">\n                    <div class="card" id="Timeline-wrap">\n                        <h1 class="Timeline-heading">Timeline</h1>\n                        <ul class="Timel-sessions full-session d-none"></ul>\n                        <span id="nodata" class="p-5">No Timeline data available.</span>\n                    </div>\n                </div>';var a=t.dataset;_entity.showTimeLine(a.processname,a.keyvalue)}),KTMenu.getInstance(e).on("kt.menu.dropdown.hide",function(e){KTMenu.getInstance(e).element.innerHTML=""})})):a.append(this.emptyRowsHtml)}function generateRowElements(e,t,a,n){var i,o='<div class="Data-fields-row">',r=_createForOfIteratorHelper(e);try{for(r.s();!(i=r.n()).done;){var s=i.value;s.fldname!=n.keycol&&(o+=_entity.generateHTMLBasedOnDataType(s,n))}}catch(f){r.e(f)}finally{r.f()}var l,c=_createForOfIteratorHelper(t);try{for(c.s();!(l=c.n()).done;){var d=l.value;d.fldname!=n.keycol&&(o+=_entity.generateHTMLBasedOnDataType(d,n))}}catch(f){c.e(f)}finally{c.f()}var u,p=_createForOfIteratorHelper(a);try{for(p.s();!(u=p.n()).done;){var m=u.value;o+=_entity.generateHTMLBasedOnDataType(m,n)}}catch(f){p.e(f)}finally{p.f()}return o+="</div>"}function generateRowButtonHTML(e,t){var a,n='<div class="Action-Btns-row ">\n                                            <div class="d-flex align-items-center ">\n                                                <a href="javascript:void(0)" title="Approve"\n                                                   onclick="axTasksObj.doApprove(\'1409660000003\', this);"\n                                                   class="btn btn-white btn-sm btn-color-gray-700 btn-active-primary d-inline-flex align-items-center  btn-sm  me-2  ">\n                                                    <span class="material-icons material-icons-style material-icons-2"\n                                                          style="color: #47BE7D;">visibility</span>View form\n                                                </a>\n                                                <a href="javascript:void(0)" title="Reject"\n                                                   class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center  me-2  btn-sm"\n                                                   onclick="axTasksObj.doReject(\'1409660000003\', this)">\n                                                    <span class="material-icons material-icons-style material-icons-2"\n                                                          style="color: red;">edit_note</span>Edit Form\n                                                </a>',i=_createForOfIteratorHelper(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;n+=_entity.generateHTMLBasedOnDataType(o,t)}}catch(r){i.e(r)}finally{i.f()}return n+=" </div>\n                                        </div>"}var dateFormat="DD/MM/YYYY",axTimeLineObj;function formatDate(e,t){var a=(e=e.split("T")[0]).split("-"),n=a[0],i=a[1],o=a[2];return"DD/MM/YYYY"===t?"".concat(o,"/").concat(i,"/").concat(n):"MM/DD/YYYY"===t?"".concat(i,"/").concat(o,"/").concat(n):e}function parseFilePath(e){var t=/^(.*[\\\/])([^\\\/]+)\.(\w+)$/.exec(e),a={folder:"",ext:"",filename:""};return t?(a.folder=t[1],a.filename=t[2],a.ext=t[3]):a.folder=e,a}function downloadFileFromPath(e,t){$.ajax({type:"POST",url:top.window.location.href.toLowerCase().substring(0,top.window.location.href.indexOf("/aspx/"))+"/customwebservice.asmx/GetAttachments",cache:!1,async:!1,contentType:"application/json;charset=utf-8",data:JSON.stringify({filePath:e,fileName:t}),dataType:"json",success:function(e){if("File not exists"!==e.d){var a=e.d.split(".").pop().toLowerCase();downloadAttachment(e.d,t,a)}else parent.showAlertDialog("error",e.d)},error:function(e){parent.showAlertDialog("error",e.d)}})}function isScrollAtBottomWithinDiv(e){return e.scrollHeight-(e.scrollTop+e.clientHeight)<=1}function isScrollAtTopWithinDiv(e){return e.scrollTop<=1}function filterRowsByPage(e,t){return e.filter(function(e){return e.pageno===t})}function initReadMore(){document.querySelectorAll(".moretext").forEach(function(e,t){var a=e.clientHeight,n=e.nextElementSibling;e.scrollHeight>e.clientHeight?(n.style.display="inline-block",e.style.maxHeight=a+"px"):n.style.display="none",n.addEventListener("click",function(){var t=window.getComputedStyle(e);"none"===t.maxHeight||t.maxHeight===a+"px"?(e.style.maxHeight=e.scrollHeight+"px",n.textContent="Read less"):(e.style.maxHeight=a+"px",n.textContent="Read more")})})}function getFilesHtml(e){var t="",a=e.axpfile_file.split(",");return $.each(a,function(a,n){var i=getFileType(n),o=getIconClass(i),r=e.axpfilepath_file+n;r=r.replace(/\\/g,"\\\\"),""!=n&&(t+='<div class="Files-Attached ">\n\t\t\t\t\t\t   \x3c!--begin::Icon--\x3e\t\n\t\t\t\t\t\t   '.concat(o,'\t\t\t\t\t\t   \n\t\t\t\t\t\t   \x3c!--end::Icon--\x3e                     \n\t\t\t\t\t\t   \x3c!--begin::Info--\x3e\n\t\t\t\t\t\t   <div class="ms-1 fw-semibold">\n\t\t\t\t\t\t\t  \x3c!--begin::Desc--\x3e\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t  <a class="attached-filename" onclick="downloadFileFromPath(\'').concat(r,"','").concat(n,"')\">").concat(n,'</a>\n\t\t\t\t\t\t\t  \x3c!--end::Desc--\x3e                     \n\t\t\t\t\t\t\t  \x3c!--begin::Number--\x3e\n\t\t\t\t\t\t\t  <div class="attached-filedetails">\n\t\t\t\t\t\t\t\t <span class="doctype">').concat(i,'</span>\n\t\t\t\t\t\t\t\t \x3c!--<span class="docsize">1.9mb</span>--\x3e\n\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t  \x3c!--end::Number--\x3e\n\t\t\t\t\t\t   </div>\n\t\t\t\t\t\t   <a class="attached-filename" onclick="downloadFileFromPath(\'').concat(r,"','").concat(n,'\')">\n\t\t\t\t\t\t\t   <span\n\t\t\t\t\t\t\t\t  class="material-icons material-icons-style material-icons-2 text-danger">cloud_download</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t   \x3c!--begin::Info--\x3e\n\t\t\t\t\t\t</div>'))}),t}function getIconClass(e){switch(e){case"pdf":return'<img src="../images/pdf.svg" class="file-img" />';case"jpeg":case"jpg":case"png":return'<img src="../images/images.svg" class="file-img" />';case"doc":case"docx":return'<img src="../images/word.svg" class="file-img" />';case"txt":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">description</i>';case"xls":case"xlsx":return'<img src="../images/xl.svg" class="file-img"/>';case"ppt":case"pptx":return'<img src="../images/ppt.svg" class="file-img"/>';case"zip":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">archive</i>';case"mp3":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">audiotrack</i>';case"mp4":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">videocam</i>';default:return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">insert_drive_file</i>'}}function getFileType(e){var t=e.split(".");return t[t.length-1].toLowerCase()}function scrollToTopOfDiv(e){e.scrollTop=0}$(document).ready(function(){_entityFilter=new EntityFilter,_entityCommon=new EntityCommon,(_entity=new Entity).init(),_entityFilter.metaData=_entity.metaData,_entityFilter.pageName="Entity",_entityFilter.entityTransId=_entity.entityTransId,_entityFilter.checkUrlFilters(),_entityFilter.applyFilters=function(){_entity.filter=this.activeFilterArray,_entity.getEntityListData(1),$("#filterModal").modal("hide")}});var ProcessTimeLine=function(){function e(){_classCallCheck(this,e),this.keyvalue="",this.processName="",this.make='<li class="make">                                   \n                    <p class="T-Desc">{{taskname}}#{{keyvalue}}</p>\n \t\t    <p class="T-Heading">{{taskfromuser}}</p>\n \t\t    <div class="time">{{tasktime}}</div>\n                </li>',this.check='<li class="check">\n                    <p class="T-Desc">{{taskname}}#{{keyvalue}} - {{taskstatus}}</p>\n                    <p class="T-Heading">{{taskfromuser}}</p>                    \n\t\t    <div class="time">{{tasktime}}</div>\n                </li>',this.approve='<li class="approve">\n                   <p class="T-Desc">{{taskname}}#{{keyvalue}} - {{taskstatus}}</p>\n                    <p class="T-Heading">{{taskfromuser}}</p>                    \n\t\t    <div class="time">{{tasktime}}</div>\n                </li>'}return _createClass(e,[{key:"getTimeLineData",value:function(){ShowDimmer(!0);var e=this,t={keyValue:e.keyvalue,processName:e.processName};this.callAPI("../aspx/AxPEG.aspx/AxGetTimelineData",t,!1,function(t){if(t.success){var a=JSON.parse(t.response),n=e.dataConvert(a,"ARM");e.constructTimeline(n),ShowDimmer(!1)}else ShowDimmer(!1)})}},{key:"constructTimeline",value:function(e){var t=this;if(this.isUndefined(e)||0==e.length)document.querySelector(".Timel-sessions").classList.add("d-none"),document.querySelector("#nodata").classList.remove("d-none");else{document.querySelector("#nodata").classList.add("d-none"),document.querySelector(".Timel-sessions").classList.remove("d-none");var a="";document.querySelector(".Timel-sessions").innerHTML="",e.forEach(function(e){a+=Handlebars.compile(t[e.tasktype.toLowerCase()])(e)}),document.querySelector(".Timel-sessions").insertAdjacentHTML("beforeend",a)}}},{key:"callAPI",value:function(e,t,a,n){var i=this,o=new XMLHttpRequest;o.open("POST",e,a),o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.isAxpertFlutter&&(o.setRequestHeader("Authorization","Bearer ".concat(armToken)),t.armSessionId=armSessionId),o.onreadystatechange=function(){4==this.readyState&&(200==this.status?n({success:!0,response:this.responseText}):(i.catchError(this.responseText),n({success:!1,response:this.responseText})))},o.send(JSON.stringify(t))}},{key:"catchError",value:function(e){showAlertDialog("error",e)}},{key:"showSuccess",value:function(e){showAlertDialog("success",e)}},{key:"dataConvert",value:function(e,t){if("AXPERT"==t)try{if("undefined"!=typeof(e=JSON.parse(e.d)).result[0].result.row)return e.result[0].result.row;if("undefined"!=typeof e.result[0].result)return e.result[0].result}catch(a){this.catchError(a.message)}else if("ARM"==t)try{if(this.isAxpertFlutter||(e=JSON.parse(e.d)),e.result&&e.result.success){if(!this.isUndefined(e.result.data))return e.result.data}else this.isUndefined(e.result.message)||this.catchError(e.result.message)}catch(a){this.catchError(a.message)}return e}},{key:"generateFldId",value:function(){return"fid".concat(Date.now()).concat(Math.floor(9e4*Math.random())+1e4)}},{key:"isEmpty",value:function(e){return""==e}},{key:"isNull",value:function(e){return null==e}},{key:"isNullOrEmpty",value:function(e){return null==e||""==e}},{key:"isUndefined",value:function(e){return void 0===e}},{key:"inValid",value:function(e){return null==e||void 0===e||""==e}}]),e}();function showPopup(e){var t=e.getAttribute("data-text");document.getElementById("popupText").textContent=t,$("#myModal").modal("show")}function formatDateString(e){if(!e)return"";var t=e.split("T"),a=t[0].split("-"),n=(t[1]||"00:00:00").split(":"),i=a[0],o=a[1],r=a[2],s=n[0],l=n[1],c=n[2],d="en-us"===dtCulture?"".concat(o,"/").concat(r,"/").concat(i):"".concat(r,"/").concat(o,"/").concat(i),u="00"!==s||"00"!==l||"00"!==c?"".concat(s,":").concat(l,":").concat(c):"";return u?"".concat(d," ").concat(u):d}var isDDMMYYYY=!0;function parseDate(e){var t,a,n,i=e.split("/");return 3!==i.length?null:(isDDMMYYYY?(t=parseInt(i[0],10),a=parseInt(i[1],10)-1,n=parseInt(i[2],10)):(a=parseInt(i[0],10)-1,t=parseInt(i[1],10),n=parseInt(i[2],10)),new Date(n,a,t))}function getLastWeek(){var e=new Date,t=e.getDay(),a=new Date(e);a.setDate(e.getDate()-t);var n=new Date(a);return n.setDate(a.getDate()-6),{start:a.toISOString().split("T")[0],end:n.toISOString().split("T")[0]}}function getCurrentWeek(){var e=new Date,t=e.getDay(),a=new Date(e);a.setDate(e.getDate()-t);var n=new Date(a);return n.setDate(a.getDate()+6),{start:a.toISOString().split("T")[0],end:n.toISOString().split("T")[0]}}function getNextWeek(){var e=new Date,t=e.getDay(),a=new Date(e);a.setDate(e.getDate()-t+7);var n=new Date(a);return n.setDate(a.getDate()+6),{start:a.toISOString().split("T")[0],end:n.toISOString().split("T")[0]}}function getLastMonth(){var e=new Date,t=e.getFullYear(),a=e.getMonth();return{start:new Date(t,a-1,2).toISOString().split("T")[0],end:new Date(t,a,1).toISOString().split("T")[0]}}function getCurrentMonth(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1;return{start:t+"-"+("0"+a).slice(-2)+"-01",end:new Date(t,a,1).toISOString().split("T")[0]}}function getNextMonth(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+2;return{start:t+"-"+("0"+a).slice(-2)+"-01",end:new Date(t,a,1).toISOString().split("T")[0]}}function getCurrentQuarter(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=Math.ceil(a/3);return{start:t+"-"+("0"+(3*(n-1)+1)).slice(-2)+"-01",end:new Date(t,3*n,1).toISOString().split("T")[0]}}function getNextQuarter(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=Math.ceil(a/3),i=3*n+1;return i>12&&(i=1,t++),{start:t+"-"+("0"+i).slice(-2)+"-01",end:new Date(t,3*n+3,1).toISOString().split("T")[0]}}function getCurrentYear(){var e=(new Date).getFullYear();return{start:e+"-01-01",end:e+"-12-31"}}function getLastYear(){var e=(new Date).getFullYear()-1;return{start:e+"-01-01",end:e+"-12-31"}}function getNextYear(){var e=(new Date).getFullYear()+1;return{start:e+"-01-01",end:e+"-12-31"}}function getDateBasedOnCulture(e){if(""!=e){var t,a=e.split(" ");if(e=a[0],"en-us"==dtCulture)(t=e.split("/")).length>2&&(e=isPerf&&4==t[0].length?t[2]+"/"+t[0]+"/"+t[1]:t[1]+"/"+t[0]+"/"+t[2]);else(t=e.split("-")).length>2&&isPerf&&4==t[0].length&&(e=t[2]+"/"+t[1]+"/"+t[0]);a[1]&&(e="".concat(e," ").concat(a[1]))}return e}function openFieldSelection(){$("#fieldsModal").modal("show"),""==$("#fields-selection").html()&&createFieldsLayout()}function createFieldsLayout(){var e=document.getElementById("fields-selection"),t=["transid","modifiedby","modifiedon","createdby","createdon","username","axpeg_nextlevel"],a=_entity.metaData.filter(function(e){return e.ftransid===_entity.entityTransId&&"F"===e.hide&&"F"==e.griddc&&-1==t.indexOf(e.fldname.toLowerCase())&&"Image"!=e.cdatatype}),n={};a.forEach(function(e){e.dcname&&(n[e.dcname]||(n[e.dcname]=[]),n[e.dcname].push(e))});var i="";Object.entries(n).forEach(function(e){var t=_slicedToArray(e,2),a=t[0],n=t[1],o=_entity.metaData.find(function(e){return e.dcname==a}).dccaption||a,r=!0;"dc1"==a&&(r=!1),i+='\n        <div class="card KC_Items">\n            <div class="card-header collapsible cursor-pointer rotate '.concat(r?"collapsed":"",'" data-bs-toggle="collapse" aria-expanded="true" data-bs-target="#fields-').concat(a,'">\n                <h3 class="card-title">').concat(o," (").concat(a,')</h3>\n                <div class="card-toolbar rotate-180">\n                    <span class="material-icons material-icons-style material-icons-2">\n                        expand_circle_down\n                    </span>\n                </div>\n            </div>\n            <div class="KC_Items_Content collapse ').concat(r?"":"show",' heightControl pt-0---" id="fields-').concat(a,'">\n            <table class="table table-hover">\n                <tbody id="fields-table-body">'),n.forEach(function(e){i+='<tr><td><input type="checkbox" id="chk_'.concat(e.fldname,'" class="chk-fields chk-relateddataflds" value="').concat(e.fldname,'" data-fldcap="').concat(e.fldcap,'" data-dcname="').concat(a,'"></td>\n          <td><label for="chk_').concat(e.fldname,'">').concat(e.fldcap||"","  (").concat(e.fldname,")</label></td></tr>")}),i+="</tbody></table></div></div>"}),i+='\n    <div class="card KC_Items">\n        <div class="card-header">\n            <h3 class="card-title">Modification Info</h3>\n        </div>\n        <div class="KC_Items_Content">\n            <table class="table table-hover">\n                <tbody>\n                    <tr><td><input type="checkbox" id="chk_modifiedby" class="chk-modification" value="modifiedby" checked></td><td><label for="chk_modifiedby">Modified By</label></td></tr>\n                    <tr><td><input type="checkbox" id="chk_modifiedon" class="chk-modification" value="modifiedon" checked></td><td><label for="chk_modifiedon">Modified On</label></td></tr>\n                    <tr><td><input type="checkbox" id="chk_createdby" class="chk-modification" value="createdby" checked></td><td><label for="chk_createdby">Created By</label></td></tr>\n                    <tr><td><input type="checkbox" id="chk_createdon" class="chk-modification" value="createdon" checked></td><td><label for="chk_createdon">Created On</label></td></tr>\n                </tbody>\n            </table>\n        </div>\n    </div>',e.innerHTML=i;var o=document.querySelectorAll(".chk-fields"),r=document.querySelectorAll(".chk-modification");"All"!=_entity.fields?(_entity.fields.split(",").forEach(function(e){document.querySelector("#chk_".concat(e))&&(document.querySelector("#chk_".concat(e)).checked=!0)}),o.length==_entity.fields.split(",").length&&(document.querySelector("#check-all").checked=!0)):(o.forEach(function(e){"dc1"==e.dataset.dcname&&(e.checked=!0)}),_entity.keyField=o[0].value),_entity.modificationFields&&"All"!=_entity.modificationFields&&_entity.modificationFields.split(",").forEach(function(e){document.querySelector("#chk_".concat(e)).checked=!0}),r.forEach(function(e){e.addEventListener("change",function(){var e,t=[];r.forEach(function(e){e.checked&&t.push(e.value)}),_entity.modificationFields=t.length>0?t.join(","):"",e={page:"Entity",transId:_entity.entityTransId,properties:{KEYFIELD:_entity.keyField,FIELDS:_entity.fields,MODIFICATIONFIELDS:_entity.modificationFields},allUsers:!1},_entityCommon.setAnalyticsDataWS(e,function(){},function(e){console.error("Error in SetEntityFieldsWS:",e),ShowDimmer(!1)})})}),setModificationFields(),updateSelectOptions()}function setModificationFields(){var e=_entity.modificationFields.split(","),t=document.querySelectorAll(".chk-modification");if(console.log("Modification Fields:",e),0!==t.length){t.forEach(function(t){t.checked=!1,e.includes(t.value)&&(t.checked=!0,!0)})}else console.error("No checkboxes found with the class 'chk-modification'.")}function updateSelectOptions(){var e=document.getElementById("selectField");e.innerHTML="";var t=document.querySelectorAll(".chk-fields");t.forEach(function(t){if(t.checked){var a=t.dataset.fldcap||"",n=document.createElement("option");n.textContent=a,n.value=t.value,e.appendChild(n)}}),e.disabled=!_toConsumableArray(t).some(function(e){return e.checked}),e.value=_entity.keyField}function applyFields(){var e=document.querySelectorAll(".chk-fields:checked");if(0!==e.length){var t=document.getElementById("selectField");if(0!==t.value&&""!==t.value){var a,n=[];e.forEach(function(e){var t=e.value;n.push(t)}),a=n.join(",");var i={page:"Entity",transId:_entity.entityTransId,properties:{FIELDS:a,KEYFIELD:t.value},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(i,function(){_entity.fields=a,_entity.keyField=t.value,_entity.setSelectedFields(),console.log("FIELDS and KEYFIELD updated successfully")},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}else showAlertDialog("error","Error: Key Field is not selected.")}else showAlertDialog("error","Error: No fields are selected.")}function resetFields(){var e=document.querySelectorAll(".chk-fields, #check-all"),t={page:"Entity",transId:_entity.entityTransId,properties:{FIELDS:"",KEYFIELD:""},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(t,function(){e.forEach(function(e){e.checked=!0}),_entity.fields="All",_entity.keyField=e[0].value,updateSelectOptions(),_entity.setSelectedFields(),console.log("Fields reset to default values")},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}function fieldsModelClose(){$("#fieldsModal").modal("hide")}function getFieldDataType(e){return _entity.inValid(e.cdatatype)?"n"==e.fdatatype?"Number":"d"==e.fdatatype?"Date":"c"==e.fdatatype?"Text":"i"==e.fdatatype?"Image":"t"==e.fdatatype?"Large Text":"Text":e.cdatatype}function getKeyField(){var e=_entity.fields.split(","),t=_entity.metaData.filter(function(t){return"T"===t.listingfld&&"T"!=t.hide&&("All"==_entity.fields&&"dc1"==t.dcname||e.indexOf(t.fldname)>-1)}),a=t.find(function(e){return"Auto Generate"===e.cdatatype});if(a)return a;var n=t.find(function(e){return"F"===e.hide&&"F"===e.allowempty&&"F"===e.allowduplicate});if(n)return n;var i=t.find(function(e){return"F"===e.hide&&"F"===e.allowempty});if(i)return i;var o=t.find(function(e){return"F"===e.hide});return o||t[0]}function getARMLogs(){var e=document.getElementById("logs-table-container");e.innerHTML="Loading logs...",$("#logsModal").modal("show");_entity.callAPI("../aspx/Entity.aspx/GetARMLogsWS",{},!0,function(t){if(t.success)try{var a=JSON.parse(JSON.parse(t.response).d);e.innerHTML=createARMLogsTable(a)}catch(n){e.innerHTML="No Logs available"}})}function createARMLogsTable(e){var t=document.createElement("table");t.className="table table-striped table-bordered";var a=document.createElement("tbody");return e.forEach(function(e){var t=document.createElement("tr"),n=document.createElement("td");n.innerText=e,t.appendChild(n),a.appendChild(t)}),t.appendChild(a),t.outerHTML}function debounce(e,t){var a;return function(){for(var n=this,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];clearTimeout(a),a=setTimeout(function(){e.apply(n,o)},t)}}var searchInput=document.getElementById("searchBox"),liveSearchDebounced=debounce(liveSearch,500);function handleSearchInput(){""===searchInput.value?liveSearch():liveSearchDebounced()}function liveSearch(){var e=document.querySelectorAll(".Project_items"),t=document.querySelectorAll("tbody tr"),a=searchInput.value.toLowerCase();e.forEach(function(e){e.innerText.toLowerCase().includes(a)?e.classList.remove("d-none"):e.classList.add("d-none")}),t.forEach(function(e){e.innerText.toLowerCase().includes(a)?e.classList.remove("d-none"):e.classList.add("d-none")})}searchInput.addEventListener("keyup",handleSearchInput),searchInput.addEventListener("input",handleSearchInput);var isCardView=!0;function toggleView(){var e=arguments.length>0&&arguments[0]!==undefined&&arguments[0];if(pageNo=1,isCardView=!isCardView,_entity.viewMode=isCardView?"card":"table",e){var t={page:"Entity",transId:_entity.entityTransId,properties:{TABLEVIEW:!isCardView},confirmNeeded:!0,storeData:e,allUsers:!1};_entityCommon.setAnalyticsDataWS(t,successCB=function(){console.log("View state saved successfully")},errorCB=function(e){showAlertDialog("error",e.status+" "+e.statusText)})}if(isCardView)$("#table-body_Container").hide(),$("#body_Container").show(),createCardViewHTML(),$("#viewIcon").text("view_module");else if($("#body_Container").hide(),$("#table-body_Container").show(),_entity.listJson.length>0){$("#table-body_Container").html(createTableViewHTML(_entity.listJson));var a=document.querySelector(".table-responsive");a.removeEventListener("scroll",scrollListener),a.addEventListener("scroll",scrollListener),$("#viewIcon").text("view_list")}else{_entity.listJson=[],document.querySelector("#table-body_Container").innerHTML=_entity.emptyRowsHtml,$("#viewIcon").text("view_module");var n=document.createElement("div");n.classList.add("no-records-message"),n.textContent="No more records",$("#table-body_Container").append(n),setTimeout(function(){$(n).remove()},3e3)}}function onToggleButtonClick(){toggleView(!0)}function formatFieldName(e){return e.replace(/([A-Z])/g," $1").replace(/createdby/g,"Created By").replace(/modifiedby/g,"Modified By").replace(/createdon/g,"Created On").replace(/modifiedon/g,"Modified On").replace(/^ /,"")}function createTableViewHTML(e,t){var a=$("#table-body_Container"),n=a.find("table").length>0,i=_entity.keyField||"",o="",r=new Set(["transid","ftransid"]),s=!e.some(function(e){return e[i]}),l=_entity.metaData.filter(function(e){return"T"===e.listingfld}),c=new Set,d=new Set,u=["modifiedby","modifiedon","createdby","createdon"];if(_entity.modificationFields&&"string"==typeof _entity.modificationFields){var p=_entity.modificationFields.split(",");p.length>0&&u.forEach(function(e){if(p.includes(e)){var t={fldname:e,fldcap:formatFieldName(e),listingfld:"T"};l.push(t)}})}else u.forEach(function(t){if(e.some(function(e){return e[t]})){var a={fldname:t,fldcap:formatFieldName(t),listingfld:"T"};l.push(a)}});if(e.forEach(function(e){for(var t in e)null===e[t]||e[t]===undefined||r.has(t)||c.add(t)}),!i||!_entity.metaData.some(function(e){return e.fldname===i})){var m=getKeyField();i=m?m.fldname:_entity.keyField}if(n)a.find("tbody").empty();else{if(o+='<div class="table-responsive"><table class="table table-striped">',o+='<thead class="sticky-header"><tr>',o+='<th><input type="checkbox" id="selectAllCheckbox" onclick="toggleSelectAll(this)"></th>',o+="<th>Edit Form</th>",c.has(i)){var f=_entity.metaData.find(function(e){return e.fldname===i});f&&(o+="<th>".concat(f.fldcap,"</th>"))}l.forEach(function(e){e.fldname===i||!c.has(e.fldname)||r.has(e.fldname)||s&&"transid"===e.fldname||d.has(e.fldname)||(o+="<th>".concat(e.fldcap,"</th>"),d.add(e.fldname))}),o+="</tr></thead><tbody>"}if(e.forEach(function(e,t){if(o+="<tr>",o+='<td><input type="checkbox" class="rowCheckbox" data-index="'.concat(t,'" data-recordid="').concat(e.recordid,'"></td>'),o+='<td><button type="button" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm me-3" data-bs-toggle="tooltip" title="Edit" data-bs-original-title="Edit" onclick="return _entity.editEntity(\''.concat(e.recordid,'\')"><span class="material-icons material-icons-style material-icons-2" style="color: red;">edit_note</span></button></td>'),c.has(i)){var a=_entity.entityName,n=_entity.entityTransId,d=e.recordid,u=e[i],p=e.rno;o+='<td><a href="#" onclick="_entity.openEntityForm(\''.concat(a,"','").concat(n,"', '").concat(d,"', '").concat(u,"', ").concat(p,')">').concat(u,"</a></td>")}else o+="<td></td>";l.forEach(function(t){if(t.fldname!==i&&c.has(t.fldname)&&!r.has(t.fldname)&&(!s||"transid"!==t.fldname)){var a=e[t.fldname],n="";n="T"===a||"F"===a?'\n                        <div class="form-check">\n                            <input class="form-check-input" type="checkbox" '.concat("T"===a?"checked":""," disabled>\n                        </div>"):"modifiedon"!==t.fldname&&"createdon"!==t.fldname&&"docdate"!==t.fldname||!a?"".concat(a||""):formatDateString(a),o+="<td>".concat(n,"</td>")}}),o+="</tr>"}),n){var y=$("#table-body_Container .table").DataTable();$.fn.DataTable.isDataTable("#table-body_Container .table")&&(y.destroy(),a.find("tbody").empty()),a.find("tbody").append(o),initializeDataTable()}else o+="</tbody></table></div>",a.append(o),initializeDataTable()}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function deleteSelectedRecordsFromToolbar(){var e=document.querySelectorAll(".rowCheckbox"),t=document.querySelectorAll(".Select-Project"),a=[].concat(_toConsumableArray(Array.from(e).filter(function(e){return e.checked}).map(function(e){return e.closest("tr").querySelector("td:nth-child(3) a").textContent.trim()})),_toConsumableArray(Array.from(t).filter(function(e){return e.checked}).map(function(e){return e.getAttribute("data-recordid")})));if(a.length>0){document.getElementById("confirmationModalBody").textContent="Are you sure you want to delete ".concat(a.length," record(s)?");var n=new bootstrap.Modal(document.getElementById("confirmationModal1"));n.show(),document.getElementById("confirmButton").addEventListener("click",function(){deleteSelectedRecords(a),a.forEach(function(e){var t=document.querySelector('.rowCheckbox[id="checkbox_'.concat(e,'"]')),a=document.querySelector('.Select-Project[id="checkbox_'.concat(e,'"]'));t&&t.closest("tr").remove(),a&&a.closest(".page-Header").remove()}),n.hide()})}else{document.getElementById("notificationModalBody").textContent="No records selected for deletion.",new bootstrap.Modal(document.getElementById("notificationModal")).show()}}function initializeDataTable(){$.fn.DataTable.isDataTable("#table-body_Container .table")&&$("#table-body_Container .table").DataTable().destroy(),table=$("#table-body_Container .table").DataTable({bInfo:!1,dom:"Bfrtip",paging:!1,searching:!1,ordering:!0,columnDefs:[{targets:0,orderable:!1}]}),$("#floatingMenu-export a").on("click",function(e){e.preventDefault();var t=$(this).data("target"),a=table.buttons(".buttons-".concat(t.toLowerCase()));a&&a.trigger()})}function handleExport(e,t){var a=_entity.entityName,n="en-us"===dtCulture?"MM/dd/yyyy":"dd/MM/yyyy";var i=_entity.listJson.length,o=_entity.entityTransId,r=function(e){switch(e.toUpperCase()){case"PDF":return"pdf";case"EXCEL":return"xlsx";case"PRINT":return"pdf";case"WORD":return"docx";default:return"pdf"}}(e),s="".concat(a,".").concat(r);if("WORD"===e.toUpperCase()||i>_entity.pageSize*_entity.maxPageNumber-1)ASB.WebService.ARMExportPushToQueue(o,"list",s,"Entity",n,_entity.fields,_entity.entityName,function(){$("#exportModal").modal("show")},function(e){console.error("Export request failed: ",e)});else{$.fn.dataTable.isDataTable("#hiddenTable")&&$("#hiddenTable").DataTable().destroy(),createHiddenTableFromMetadata(),function(e,t){if(e.buttons)switch(t.toUpperCase()){case"PRINT":e.button(".buttons-print").trigger();break;case"PDF":e.button(".buttons-pdf").trigger();break;case"EXCEL":e.button(".buttons-excel").trigger();break;default:console.error("Unsupported export action: "+t)}else console.error("Buttons are not initialized for the table")}($("#hiddenTable").DataTable({layout:{topStart:{buttons:["copy","csv","excel","pdf","print"]}}}),e)}}function createHiddenTableFromMetadata(){$("#hiddenTableContainer").empty();var e='<table id="hiddenTable" class="display nowrap" style="width:100%">\n        <thead><tr>',t=[];_entity.metaData.forEach(function(a){"T"!==a.hide&&(_entity.listJson.some(function(e){return e[a.fldname]&&""!==e[a.fldname].trim()})&&(t.push(a),e+="<th>".concat(a.fldcap,"</th>")))}),e+="</tr></thead><tbody>",_entity.listJson.forEach(function(a){var n=!1,i="<tr>";t.forEach(function(e){var t=a[e.fldname]||"";if(""!==t){if(n=!0,isDateField(e)){var o=new Date(t);if(!isNaN(o))if("modifiedon"===e.fldname.toLowerCase()){var r=o.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),s=o.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit"});t="".concat(r," ").concat(s)}else t=o.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}else t=t.replace("T"," ").replace(/Z$/,"");i+="<td>".concat(t,"</td>")}else i+="<td></td>"}),i+="</tr>",n&&(e+=i)}),e+="</tbody></table>",$("#hiddenTableContainer").append(e)}function isDateField(e){return"Date"===e.cdatatype||"d"===e.fdatatype||"modifiedon"===e.fldname.toLowerCase()}function toggleSelectAll(e){var t=document.querySelectorAll(".rowCheckbox");t.forEach(function(t){t.checked=e.checked});var a=Array.from(t).filter(function(e){return e.checked}).map(function(e){return e.closest("tr").querySelector("td:nth-child(3) a").textContent.trim()});a.length>0&&deleteSelectedRecords(a)}function showNotification(e){document.querySelector("#notificationModal .modal-body").textContent=e,new bootstrap.Modal(document.getElementById("notificationModal")).show()}function deleteSelectedRecords(){var e=document.querySelectorAll(".rowCheckbox:checked"),t=document.querySelectorAll(".Select-Project:checked"),a=[].concat(_toConsumableArray(e),_toConsumableArray(t));if(0!==a.length){var n=[],i="";a.forEach(function(e,t){var a=e.getAttribute("data-recordid");n.push(a),i+="\n            <row>\n                <rowno>".concat(t+1,"</rowno>\n                <recordid>").concat(a,"</recordid>\n            </row>")});var o=window.top.axTraceFlag?"♦♦DeleteRow-".concat(_entity.entityTransId,"♦"):"",r={recIds:n.join(","),transid:_entity.entityTransId,s:'<root axpapp="'.concat(window.top.mainProject,'" trace="').concat(o,'" sessionid="').concat(window.top.mainSessionId,'" stype="iviews" sname="').concat(_entity.entityTransId,'" actname="delete">\n            <varlist>').concat(i,"</varlist>\n        ")};console.log("Request Payload:",r),ASB.WebService.DeleteIviewRow(r.recIds,r.transid,r.s,function(e){if(e){var t,a;if(response=JSON.parse(e),response.error)return void showAlertDialog("error",null===(t=response.error)||void 0===t?void 0:null===(a=t[0])||void 0===a?void 0:a.msg);showNotification("Records deleted successfully."),_entity.reloadEntityPage()}else showNotification("Failed to delete records. Please try again.")},function(e){console.error("Error details:",e),showNotification("Error while deleting records. Please try again.")})}else showNotification("Please select at least one record to delete.")}function createCardViewHTML(){createListHTML(_entity.listJson,1)}function scrollListener(e){var t=e.target,a=t.scrollTop,n=t.scrollLeft;this.lastScrollTop!==a&&(this.lastScrollTop=a,!isFetching&&isScrollAtBottomWithinDiv(t)&&(isFetching=!0,pageNo++,_entity.getEntityListData(pageNo),setTimeout(function(){isFetching=!1},500))),this.lastScrollLeft=n}function handleNoChartData(){document.querySelectorAll(".analytics-container, .entity-card").forEach(function(e){e.classList.add("d-none")}),document.querySelectorAll(".nodata, .NO-KPI-Items").forEach(function(e){e.classList.remove("d-none")})}function handleValidChartData(){document.querySelectorAll(".analytics-container, .entity-card").forEach(function(e){e.classList.remove("d-none")}),document.querySelectorAll(".nodata, .NO-KPI-Items").forEach(function(e){e.classList.add("d-none")})}function selectView(e){_entity.tableViewFlag="table"===e;var t=document.getElementById("tableView"),a=document.getElementById("listView");_entity.tableViewFlag?(t.classList.add("selected"),a.classList.remove("selected")):(a.classList.add("selected"),t.classList.remove("selected"))}function selectCaptions(e){_entity.captionsEnabled="visible"===e;var t=document.getElementById("visible"),a=document.getElementById("hidden");_entity.captionsEnabled?(t.classList.add("selected"),a.classList.remove("selected")):(a.classList.add("selected"),t.classList.remove("selected"))}function highlightInitialSelection(){_entity.tableViewFlag?selectView("table"):selectView("list"),_entity.captionsEnabled?selectCaptions("visible"):selectCaptions("hidden")}function toggleRightPanel(){var e=document.getElementById("Entity_management_Right"),t=document.querySelector("button[onclick='toggleRightPanel();']"),a=window.getComputedStyle(e).getPropertyValue("display"),n={page:"Entity",transId:_entity.entityTransId,properties:{RIGHTPANEL:"none"===a?"expanded":"collapsed"},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(n,function(){"none"===a?(e.style.setProperty("display","block","important"),t.style.setProperty("display","none","important"),_entity.properties.RIGHTPANEL="expanded"):(e.style.setProperty("display","none","important"),t.style.setProperty("display","inline-block","important"),_entity.properties.RIGHTPANEL="collapsed")},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}function togglePin(){var e=document.getElementById("Entity_management_Right"),t=document.querySelector("button[onclick='toggleRightPanel();']"),a=window.getComputedStyle(e).getPropertyValue("display"),n={page:"Entity",transId:_entity.entityTransId,properties:{RIGHTPANEL:"none"===a?"expanded":"collapsed"},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(n,function(){"none"===a?(e.style.setProperty("display","block","important"),t.style.setProperty("display","none","important"),_entity.properties.RIGHTPANEL="expanded"):(e.style.setProperty("display","none","important"),t.style.setProperty("display","inline-block","important"),_entity.properties.RIGHTPANEL="collapsed"),console.log("RIGHTPANEL updated successfully")},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}$(document).ready(function(){$(".entity-card").on("click",function(){var e=$("#Homepage_CardsList_Wrapper"),t=$(this).find(".arrow-icon");e.hasClass("show")?e.removeClass("show").slideUp():e.addClass("show").slideDown(),t.toggleClass("fa-chevron-down fa-chevron-up")})});